\chapter{Oscillazioni}

\lecture{3}{5 marzo 2024}
\section{Soluzione generale}

Proviamo a risolvere l'equazione dell'oscillatore armonico forzato in maniera generale:
\begin{equation}
	\label{eq:linear}
	m \ddot{x} + \beta \dot{x} + kx = f(t) \to x(t) = x_{omo}(t) + x_{part}(t) 
\end{equation}

È un'equazione lineare non omogenea, quindi prevede dei gradi di libertà nella soluzione omogenea (ovvero dipende dalle condizioni iniziali), mentre la soluzione particolare è fissata (non dipende dalle condizioni iniziali).

\begin{lemma}
	[Principio di sovrapposizione]
	Se \(x_{1}(t)\) e \(x_{2}(t)\) sono due soluzioni dell'omogenea, allora \(x_{omo}(t) = a x_{1}(t) + b x_{2}(t)\) per ogni valore di \(a\) e \(b\).   
\end{lemma}

Si può introdurre un nuovo oggetto matematico: un "operatore funzionale". Al primo membro dell'equazione \eqref{eq:linear} c'è come incognita la funzione \(x\), quindi possiamo costruire un'operazione da applicare ad \(x\), \(\hat{L} \), che restituisca il primo membro dell'equazione.

\[
	\hat{L} = m \frac{\mathrm{d}^2}{\mathrm{d}t^2} + \beta \frac{\mathrm{d}}{\mathrm{d}t} + k \to \hat{L} (x) = m \frac{\mathrm{d}^2 x}{\mathrm{d}t^2} + \beta \frac{\mathrm{d}x}{\mathrm{d}t} + kx
\]

L'equazione dell'oscillatore armonico diventa quindi \(\hat{L} (x) = f(t)\) con incognita \(x(t)\). Questa è detta "notazione operatoriale".

\begin{definition}
	[Classe di operatori lineari]
	Gli operatori lineari hanno due proprietà:
	\begin{enumerate}
		
		\item L'operatore si distribuisce sulla somma: \(\forall x,y\ \hat{L} (x+y) = \hat{L} (x) + \hat{L} (y)\)
		\item \(\forall \) funzione \(x\) e \(\forall \) costante \(a\), \(\hat{L} (ax) = a \hat{L} (x)\)    
	\end{enumerate}
\end{definition}

\begin{eg}
	Conosciamo già esempi di operatori lineari:
	\begin{itemize}
		
		\item Moltiplicazione per costante: \(\hat{L} (x)=\mu x(t)\)
		\item Derivata (n-esima): \(\hat{L} (x) = \frac{\mathrm{d}x(t)}{\mathrm{d}t} \), \(\hat{L} (x) = \frac{\mathrm{d}^n x(t)}{\mathrm{d}t^n} \)
		\item Integrale: \(\hat{L} (x) = \int_{}^{t} x (t^{\prime} ) \,\mathrm{d}t^{\prime}\), \(\hat{L} (x) = \int_{}^{t} x (t^{\prime} )g(t^{\prime} ) \,\mathrm{d}t^{\prime}  \) 
		\item Qualsiasi combinazione lineare dei precedenti.
	\end{itemize}
\end{eg}

L'equazione dell'oscillatore armonico forzato contiene combinazioni di esse, quindi \(\hat{L} \) è un operatore lineare. Studiamone le proprietà.

\paragraph{Equazione omogenea}

Ogni combinazione lineare di soluzioni è soluzione: se \(\hat{L} (x_{1} ) = 0\) e \(\hat{L} (x_{2}) = 0\) allora \(x_{1}(t) \) e \(x_{2}(t) \) sono soluzioni. Per la seconda proprietà degli operatori lineari anche \(ax_{1}(t),\ bx_{2}(t)  \) sono soluzioni, mentre per la prima proprietà lo è anche la loro combinazione lineare.

È possibile dimostrare che, se \(\hat{L} \) ha derivate fino all'ordine \(n\), allora esistono al massimo n soluzioni indipendenti che si possono combinare, quindi n costanti arbitrarie (eventualmente da determinare conoscendo le condizioni iniziali).

\paragraph{Equazione non omogenea} Se ho una soluzione particolare e una omogenea, la combinazione lineare senza coefficienti liberi è soluzione. Ogni soluzione è costruita come somma di una soluzione particolare e una soluzione dell'omogenea. Questo si vede semplicemente dall'applicazione delle due proprietà degli operatori lineari.

\paragraph{Termine noto scritto come somma di funzioni} Una volta trovata la soluzione per \(f_1\) e \(f_2\) (gli addendi della somma) il problema è risolto, poiché la somma delle soluzioni particolari è soluzione generale, sempre per la prima proprietà degli operatori lineari.

Studiamo un oscillatore smorzato con una forzante costante sommata a due funzioni dipendenti dal tempo:
\[
	m \ddot{x} + \beta \dot{x} + kx = - mg + F_1 \cos(\Omega t)+ F_2 \sin(2 \Omega t)= \hat{L} (x)
\]
Sfruttiamo la linearità:
\begin{enumerate}
	\item Cerchiamo la soluzione omogenea: \(\hat{L} (x_{omo} ) = 0\). È un oscillatore smorzato con la stessa soluzione già trovata in precedenza: \(x_{omo} (t) = A_0 e^{-\frac{t}{2 \tau }}\cos (\omega t + \phi _0) \).
	\item Cerchiamo soluzioni delle tre forzanti separatamente:
	\begin{itemize}
		
		\item Il primo termine rappresenta una forzante costante. La soluzione è nota: \(x_{0p} = -\frac{mg}{k}\).
		\item La seconda forzante è armonica, soluzione già vista:
		\[
			x_{1p} = \frac{F_1}{m \sqrt{(\omega _p ^{2} - \Omega ^{2} )^{2} + (\gamma \Omega )^{2} } }\cos (\Omega t - \delta ) 
		\]
		
		\item La terza forzante non l'abbiamo ancora studiata, ma è possibile risolverla applicando un metodo simile a quello applicato per il coseno. Il seno è la parte immaginaria di un fasore.
		\[
			m\ddot{x} + \beta \dot{x}  + kx = F_2 \sin 2\Omega t \to \ddot{z} + \gamma \dot{z}  + \omega _0 z = \frac{F_2}{m} e^{i2\Omega t} 
		\]
		dove \(x(t) = \Im (z(t))\). Suppongo una soluzione del tipo \(z(t)=A e^{\lambda t}\) e ottengo \((\lambda ^{2} + \gamma \lambda +\omega _0) A e^{\lambda t}=\frac{F_2}{m} e^{i2\Omega t} \). Siccome l'uguaglianza deve essere sempre valida, ottengo che \(\lambda = 2\Omega i \).
		\[
			(-4\Omega ^{2} + 2i \Omega \gamma +\omega _0) A = \frac{F_2}{m} \implies  A = \frac{F_2}{m \left[(\omega _0 ^{2} -4\Omega ^{2}) + i2\gamma \Omega \right]}
		\]
		Posso scrivere A come numero complesso con fase \(\delta = \frac{2\gamma \Omega }{\omega _0^{2} -4\Omega ^{2} }\)  e ottenere
		\[
			z(t) = \frac{F_2}{m\sqrt{(\omega _0 ^{2} -4\Omega ^{2} )^{2} +4\gamma ^{2} \Omega ^{2} } }\frac{e^{i2\Omega t} }{e^{\delta }}
		\]
		Di conseguenza,
		\[
			x(t)= \Im (z(t))=\frac{F_2}{m\sqrt{(\omega _0^{2} -4\Omega ^{2} )^{2} + 4\gamma ^{2} +\Omega ^{2}  } }\sin (2\Omega t-\delta )
		\]
	\end{itemize}
\end{enumerate}

La soluzione finale sarà quindi la somma dei quattro termini: con la somma di funzioni nella forzante ho diviso il problema in varie parti più semplici. La fisica cerca sempre equazioni lineari: ad esempio, in elettromagnetismo il primo strumento utilizzato per misurare la carica fu l'elettroscopio a foglie, tuttavia non venne utilizzato per definire la carica perché la relazione fra angolo di apertura e carica non è lineare. Le equazioni di Maxwell sono invece tutte di natura lineare: la divergenza è lineare perché contiene derivate e appaiono tutte al grado 1. Anche l'equazione di D'Alembert è un'equazione lineare, così come l'equazione di Schrodinger.

Il "principio di sovrapposizione" vale quindi solo nei sistemi lineari. È l'espressione fisica del concetto di operatore lineare: cerchiamo un problema lineare perché attraverso tale principio possiamo spacchettarlo in problemi più semplici.

\section{Serie di Fourier}

Trattiamo ora uno degli strumenti più potenti per risolvere equazioni lineari, tra cui problemi di forzante generica scomponendola in casi particolari. Come generalizziamo quanto studiato finora?
\begin{enumerate}
	\item Primo passo: consideriamo \(f(t)\) periodica con periodo T. Quando una funzione è periodica la possiamo risolvere se il periodo è limitato. Questo è il caso del tema di questa sezione, la serie di Fourier.
	\item Secondo passo: considerare una funzione non periodica, in altre parole con periodo \(T \to \infty \). Questo verrà trattato invece con la trasformata di Fourier. 
\end{enumerate}

Iniziamo costruendo una forzante particolare, periodica, per cui posso anche moltiplicare la pulsazione per una costante, con fase iniziale:
\[
	f(t) = F_0 + \sum_{n=1}^{\infty} F_n \cos (n \omega t + \phi _n) \text{ con } \omega = \frac{2\pi }{T} 
\]
\(f(t)\) è somma di funzioni di periodo \(T, \frac{T}{2}, \frac{T}{3}, \dots \) quindi è complessivamente periodica di periodo T (domina n=1). Risolviamo cercando:
\[
	\hat{L} (x_0)=F_0, \dots , \hat{L} (x_n)= F_n \cos (n \omega t + \phi _n)
\]
Come al solito, è più conveniente studiare la funzione complessa associata. Posso scrivere \(\hat{L} (x_n)=\Re [F_n e^{i \phi _n}e^{in \omega t} ]\). L'equazione n-esima diventa quindi \(m \ddot{z_n} + \beta \dot{z_n} + k z_n = (F_n e^{i \phi _n})e^{in \omega t}\). Siccome il primo membro deve eguagliare il secondo membro per ogni t, deve esserci la stessa dipendenza temporale a esponente. Pongo \(z_n(t)=A_n e^{\lambda _n t} \implies \lambda _n = in \omega \). Definendo \(\gamma =\frac{\beta }{m},\ \omega _n ^{2} = \frac{k}{m}\) posso isolare l'ampiezza:
\[
	A_n = \frac{F_n e^{i \phi _n}}{m [(\omega _0 ^{2} -(n \omega )^{2} ) + i \gamma n \omega ]}
\]
La differenza dalle soluzioni viste in precedenza sta nel fatto che in questo caso \(\Omega \) è sostituita da \(n \omega \). La soluzione complessa è
\begin{gather*}
	z_n(t) = A e^{in \omega t}= \frac{F_n e^{i(n \omega t + \phi _n)}}{m [(\omega _0 ^{2} -(n \omega )^{2} )+i \gamma n \omega ]}\\
	x(t)= \Re [z_n(t)]= \frac{F_n}{m}\Re \left[\frac{e^{i(n \omega t + \phi _n)}}{(\omega _0 ^{2} - (n \omega )^{2} )+i \gamma n \omega }\right] 
\end{gather*}
Le fasi \(\phi _n \) sono eliminabili utilizzando la formula nota per il coseno della somma \(\cos (\alpha +\beta )=\cos \alpha \cos \beta -\sin \alpha \sin \beta \rightsquigarrow F_n \cos (n \omega t + \phi _n) = F_n \cos \phi _n \cos (n \omega t) - F_n \sin \phi _n \sin (n \omega t) \). Si può quindi porre \(a_0 =F_0,\ a_n = F_n \cos \phi _n,\ b_n =-F_n \sin \phi _n\) per ottenere \(F_n \cos (n \omega t + \phi _n) = a_n \cos (n \omega t) + b_n \sin (n \omega t)\).
Ottengo quindi che
\[
	f(t) = a_0 + \sum_{n=1}^{\infty} [a_n \cos (n \omega t) + b_n \sin (n \omega t)]
\]

\begin{theorem}
	[Teorema delle serie di Fourier]
	Ogni funzione \(f(t)\) limitata, periodica di periodo T, continua o con al più un numero finito di punti di discontinuità con salto (limite destro e sinistro diversi ma finiti) si può sempre approssimare con la serie
	\[
		f_N(t)=a_0 + \sum_{n=1}^{N } [a_n \cos (n \omega t) + b_n \sin (n \omega t)] 
	\]
	dove \(\omega = \frac{2\pi }{T}\).
\end{theorem}

Per opportuni valori di \(a_n\) e \(b_n\) si ha che \(f_N(t)\xrightarrow{N \to +\infty }f(t)\) su tutti i punti di continuità del dominio. Gli scarti vanno a zero se N va a infinito:
\[
	\forall \varepsilon,\ \exists N \text{ tale che } \int_{0}^{T} (f(t) - f_N(t))^{2}  \,\mathrm{d}t < \varepsilon 
\]

\paragraph{Trovare i coefficienti \(a_n\) e \(b_n\)} Per trovare i coefficienti della serie di Fourier è necessario conoscere le proprietà di ortonormalità delle funzioni trigonometriche. Per n e m interi valgono le seguenti:
\begin{itemize}
	
	\item \(\int_{0}^{T} \cos (n \omega t) \cos (m \omega t) \,\mathrm{d}t = \frac{T}{2} \delta_{nm}  \) 
	\item \(\int_{0}^{T} \sin (n \omega t) \sin (m \omega t) \,\mathrm{d}t = \frac{T}{2} \delta_{nm}  \)
	\item \(\int_{0}^{T} \cos (n \omega t) \sin (m \omega t) \,\mathrm{d}t = 0 \)  
\end{itemize}
dove \(\delta_{nm} \) è il delta di Kronecker. È chiaro capire che il motivo di queste proprietà è dato dal fatto che, se m e n sono diversi si sta mediando una funzione sia positiva che negativa con media nulla, mentre se m e n sono uguali \(\sin \text{ e } \cos \) sono elevati al quadrato.

\begin{definition}
	[Funzione di scarto]
	Riprendiamo la definizione precedentemente accennata di funzione di scarto:
	\begin{gather*}
		\lambda _N (a_0, a_n, b_n; n=1,\dots ,N)=\int_{0}^{T} (f(t)-f_N(t))^{2}  \,\mathrm{d}t=\\
		=\int_{0}^{T} \left\{ f(t) - a_0 - \sum_{n=1}^{N} [a_n \cos (n \omega t) + b_n \sin (n \omega t)] \right\} ^{2}  \,\mathrm{d}t
	\end{gather*}
	Per definizione \(\lambda _N \geq 0\). 
\end{definition}

Al fine di avere la migliore possibile rappresentazione della funzione \(f(t)\) è necessario che lo scarto \(\lambda _N\) sia minimo. Considerando un parametro alla volta, \(\lambda _N(a_n, b_n)\) è una funzione quadratica e ha quindi un unico minimo \(\rightsquigarrow \) esisterà un insieme di valori \(a_n, b_n\) che minimizza il valore di \(\lambda _N\). La condizione di minimo si può esprimere come segue:
\[
	\frac{\partial \lambda _N (a_0, a_n,b_n;n=1,\dots ,N)}{\partial a_m}=0 
\]
Sviluppando i calcoli si ottiene:
\begin{gather*}
	-2\int_{0}^{T} \cos (m \omega t) \left\{ f(t) - a_{0} - \sum_{n=1}^{N}[a_n \cos (n \omega t) + b_n \sin (n \omega t)]   \right\} \,\mathrm{d}t = 0\\
	\int_{0}^{T} \cos (m \omega t) f(t) \,\mathrm{d}t - \left\{a_0 \int_{0}^{T} \cos (m \omega t) \,\mathrm{d}t + \sum_{n=1}^{N} a_n \int_{0}^{T} \cos (n \omega t) \cos (m \omega t) \,\mathrm{d}t +\right.\\
	+ \left. \sum_{n=1}^{N} b_n \int_{0}^{T} \sin (n \omega t) \cos (m \omega t) \,\mathrm{d}t\right\} = 0
	\rightsquigarrow \int_{0}^{T} \cos (m \omega t) f(t) \,\mathrm{d}t = \frac{T}{2}a_m
\end{gather*}
perché per le proprietà di ortonormalità delle funzioni trigonometriche viene selezionato solo l'm-esimo termine della sommatoria contenente i termini \(a_n\).
Di conseguenza, \(a_n = \frac{2}{T} \int_{0}^{T} \cos (n \omega t) f(t) \,\mathrm{d}t \). Allo stesso modo è possibile ricavare le espressioni per gli altri coefficienti:
\begin{formula}
	[Coefficienti della serie di Fourier]\leavevmode
\begin{itemize}
	\item \(a_0 = \frac{1}{T} \int_{0}^{T} f(t) \,\mathrm{d}t \)
	\item \(a_n = \frac{2}{T} \int_{0}^{T} f(t) \cos (n \omega t) \,\mathrm{d}t \)
	\item \(b_n = \frac{2}{T} \int_{0}^{T} f(t) \sin (n \omega t) \,\mathrm{d}t \)   
\end{itemize}
\end{formula}
Si dimostra che per questa scelta di parametri \(\lambda _N \to 0 \text{ se } N \to \infty \).
È immediato riscrivere i risultati ottenuti tramite fasori:
\begin{align}
	\cos (n \omega t) &= \frac{e^{in \omega t} + e^{-in \omega t} }{2}
	&
	\sin (n \omega t) &= \frac{e^{in \omega t} - e^{-in \omega t}  }{2i}
\end{align}
Ponendo \(c_0 = a_0 \text{, } c_n = \frac{a_n}{2} + \frac{b_n}{2i} \text{, } c_{-n} = \frac{a_n}{2} - \frac{b_n}{2i}  \), si ottiene che
\[
	a_n \cos (n \omega t) + b_n \sin (n \omega t) = c_n e^{in \omega t} + c_{-n} e^{-in \omega t}
\]
La serie di Fourier diventa quindi
\[
	f(t) = \sum_{n=-\infty}^{+\infty} c_n e^{in \omega t}
\]
Dalla definizione di \(c_n\) si ottiene che
\begin{gather*}
	c_n = \left(\frac{a_n}{2}+\frac{b_n}{2i}\right) = \frac{1}{T} \int_{0}^{T} f(t) \cos (n \omega t) \,\mathrm{d}t - i \frac{1}{T} \int_{0}^{T} f(t) \sin (n \omega t) \,\mathrm{d}t =\\
	= \frac{1}{T} \int_{0}^{T} f(t) e^{-in \omega t} \,\mathrm{d}t 
\end{gather*}

\begin{definition}
	[Serie complessa di Fourier]
	La serie complessa di Fourier è quindi definita come 
	\[
		f(t) = \sum_{n=-\infty}^{+\infty} c_n e^{in \omega t} \text{ con } c_n = \frac{1}{T} \int_{0}^{T} f(t) e^{-in \omega t} \,\mathrm{d}t 
	\]
\end{definition}
Attraverso la serie complessa di Fourier diventa immediato risolvere un problema con forzante periodica generica. Per ogni n si ha infatti una soluzione \(x_n(t)=\frac{c_n}{m [(\omega _0 ^{2} - (n \omega )^{2} )+i \gamma n \omega ]}e^{in \omega t} \) e quindi
\[
	x_{part}(t)=\sum_{n=-\infty }^{\infty} \frac{c_n}{m [(\omega _0 ^{2} - (n \omega )^{2} )+i \gamma n \omega ]}e^{in \omega t}
\]